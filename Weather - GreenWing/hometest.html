<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenWing | Welcome Page</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸª½</text></svg>">
    <link rel="stylesheet" href="./hometest.css">
    <link rel="stylesheet" href="./weathercard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <div class="main_div">
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <img src="./GreenWing_Logo.png" alt="GreenWing">
            </div>
            <nav class="navigation">
                <ul class="nav-list">
                    <li class="nav-item active"><a href="#">Overview</a></li>
                    <li class="nav-item"><a href="#">Fields</a></li>
                    <li class="nav-item"><a href="./home.html">Sensors</a></li>
                    <li class="nav-item"><a href="#">Analytics</a></li>
                </ul>
            </nav>
            <div id="container">
                <div id="text-area">
                    <p class="New_card_header"> New!</p>
                    <p id="dynamic-text">New! Ready to contact real farmers near?</p>
                </div>
            </div>
            <div class="logout">
                <a href="#">Logout â†’</a>
            </div>
        </aside>
        <div class="main-container">
            <header class="header">
                <div class="hamburger-menu">
                    <button id="sidebarToggle">&#9776;</button>
                </div>
                <div class="company-name">
                    <select>
                        <option value="exotic_inc">Test Company</option>
                        <option value="exotic_inc">Test Company2</option>
                        <option value="exotic_inc">Test Company3</option>

                    </select>
                </div>
                <div class="company-name2">
                    <select>
                        <option value="exotic_inc">â†“ </option>
                        <option value="exotic_inc">Test Company2</option>
                        <option value="exotic_inc">Test Company3</option>

                    </select>
                </div>

                <div class="search-bar">

                    <form class="weather__search">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search by Location, Vegetable, Metric..."
                            class="weather__search-input">
                    </form>
                </div>
                <div class="profile-info">
                    <img src="https://via.placeholder.com/150" alt="Profile Picture" class="profile-pic">
                    <span class="profile-name">Deeghayu Suwahas</span>
                </div>
            </header>
            <div class="content">
                <div class="grid2">
                    <section class="weather-forecast">
                        <!-- Weather forecast -->
                        <h1 class="header-title"> Weather Forecast â¬‡</h1>
                        <div class="weather__div">
                            <div class="weather day1">
                                <div class="weather-card">
                                    <div class="card__image">
                                        <div class="weather">
                                            <div class="weather__sun">
                                                <div class="curve curve--sun"></div>
                                            </div>
                                            <div class="weather__cloud"></div>
                                            <div class="weather__cloud weather__cloud--big"></div>
                                            <div class="weather__rain-container">
                                                <div class="weather__lightning-flash" style="display: none;"></div>
                                                <div class="weather__rain" style="display: none;"></div>
                                            </div>


                                        </div>
                                        <div class="landmark landmark--merlion"></div>
                                        <div class="landmark">
                                            <div class="landmark__tower landmark__tower--left">
                                                <div class="base-1"></div>
                                                <div class="base-2"></div>
                                                <div class="base-3"></div>
                                            </div>
                                            <div class="landmark__tower landmark__tower--middle">
                                                <div class="bar bar--1"></div>
                                                <div class="bar bar--2"></div>
                                                <div class="bar bar--3"></div>
                                                <div class="bar bar--4"></div>
                                            </div>
                                            <div class="landmark__tower landmark__tower--right">
                                                <div class="base-1"></div>
                                                <div class="base-2"></div>
                                                <div class="base-3"></div>
                                            </div>
                                            <div class="curve curve--left curve--left-1"></div>
                                            <div class="curve curve--left curve--left-2"></div>
                                            <div class="curve curve--right curve--right-1"></div>
                                            <div class="curve curve--right curve--right-2"></div>
                                        </div>
                                    </div>
                                    <div class="card__content">
                                        <br><span class="card__content__city"></span><br>
                                        <span class="card__content__details"><span class="details__day"></span><span
                                                class="details__date"></span><span class="details__time"></span></span>
                                        <div class="card__temp-wrapper"><span class="card__temp"
                                                id="min-temp"></span><span
                                                class="card__temp card__temp--current"></span><span class="card__temp"
                                                id="max-temp"></span></div>
                                    </div>
                                </div>

                            </div>
                            <div class=" weather__gap">
                                <div class="weather2 day2">
                                    <div class="weather-card-min">
                                        <div class="weather-card-min__info">
                                            <span class="weather-card-min__info__condition">Very, Very Sunny</span>
                                            <br>
                                            <span class="weather-card-min__info__date2">Jan 17</span>
                                        </div>
                                        <div class="weather-card-min-other">
                                            <div class="weather-card-min__icon"></div>
                                            <div>
                                                <span class="weather-card-min__info__date1">+1 Day</span>
                                                <br>
                                                <span class="weather-card-min__weather__temp">18Â° C</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="weather2 day3">
                                    <div class="weather-card-min">
                                        <div class="weather-card-min__info">
                                            <span class="weather-card-min__info__condition">Very Sunny</span>
                                            <br>
                                            <span class="weather-card-min__info__date2">Jan 17</span>
                                        </div>
                                        <div class="weather-card-min-other">
                                            <div class="weather-card-min__icon"></div>
                                            <div>
                                                <span class="weather-card-min__info__date1">+2 Day</span>
                                                <br>
                                                <span class="weather-card-min__weather__temp">18Â° C</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="weather2 day4">
                                    <div class="weather-card-min">
                                        <div class="weather-card-min__info">
                                            <span class="weather-card-min__info__condition">Very Sunny</span>
                                            <br>
                                            <span class="weather-card-min__info__date2">Jan 17</span>
                                        </div>
                                        <div class="weather-card-min-other">
                                            <div class="weather-card-min__icon"></div>
                                            <div>
                                                <span class="weather-card-min__info__date1">+3 Day</span>
                                                <br>
                                                <span class="weather-card-min__weather__temp">18Â° C</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="weather2 day5">
                                    <div class="weather-card-min">
                                        <div class="weather-card-min__info">
                                            <span class="weather-card-min__info__condition">Very Sunny</span>
                                            <br>
                                            <span class="weather-card-min__info__date2">Jan 17</span>
                                        </div>
                                        <div class="weather-card-min-other">
                                            <div class="weather-card-min__icon"></div>
                                            <div>
                                                <span class="weather-card-min__info__date1">+4 Day</span>
                                                <br>
                                                <span class="weather-card-min__weather__temp">18Â° C</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </section>
                </div>
                <div class="grid">
                    <h1 class="header-title"> This Week's Progress â¬‡</h1>
                    <section class="weekly-progress">
                        <div class="card chilly">
                            <div class="card-content">
                                <div class="title">Chilly</div>
                                <div class="percentage">Growth: 75%</div>
                            </div>
                        </div>

                        <div class="card nut">
                            <div class="card-content">
                                <div class="title"> Ground Nut</div>
                                <div class="percentage">Growth: 60%</div>
                            </div>
                        </div>

                        <div class="card mukunuwenna">
                            <div class="card-content">
                                <div class="title">Mukunuwenna</div>
                                <div class="percentage">Growth: 85%</div>
                            </div>
                        </div>

                        <div class="card plus">
                            <div class="card-content">
                                <div class="add">âž•</div>
                                <div class="add"></div>
                            </div>
                        </div>

                    </section>
                    <h1 class="header-title"> Charts â¬‡</h1>
                    <section class="chart predictive-analysis">
                        <div class="chart1">
                            <canvas id="predictive-analysis-chart"></canvas>
                        </div>
                        <div class="chart2">
                            <h1>It's the perfect day for spraying</h1>
                            <div class="chart2-container">
                                <div class="chart2-div">
                                    <div class="chart2-img"></div>
                                </div>
                                <div class="chart2-div">
                                    <div class="chart2-data">
                                        <span class="real-time-temp">4,39 Â°C</span>
                                        <span class="chart2-description">Real-Time Temperature</span>
                                      </div>
                                      <div class="chart2-data">
                                        <span class="real__soil">pH 7</span>
                                        <span class="chart2-description">Real-Time Soil Moisture</span>
                                      </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <h1 class="header-title"> Real Time Data â¬‡</h1>
                    <section class="data-show">
                        <div class="data">
                            <div class="weather__card">
                                <i class="fa-solid fa-water"></i>
                                <div>
                                    <span>Real Time Humidity :</span>
                                    <span class="real-time-humidity">99.9%</span>
                                </div>
                            </div>
                        </div>
                        <div class="data">
                            <div class="weather__card">
                                <i class="fa-solid fa-sun-plant-wilt"></i>
                                <div>
                                    <span>Real Time Solar Intensity :</span>
                                    <span class="real__sun">18&#176</span>
                                </div>
                            </div> 
                        </div>
                        <div class="data">
                            <div class="weather__card">
                                <i class="fa-solid fa-car-battery"></i>
                                <div>
                                    <span>Battery Level :</span>
                                    <span class="battery_charging">18&#176</span>
                                    <span class="battery__level">18&#176</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>



                <div id="rotateWarning"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); color: white; font-size: 24px; text-align: center;  justify-content: center; z-index: 9999; align-items: center;">
                    <p>Please rotate your device to view this website properly.</p>
                </div>

                <script src="./weathercard.js"></script>
                <script src="./hometest.js"></script>
                <script>
                    document.addEventListener("DOMContentLoaded", function () {
                        fetch('./getdata.php')
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Network response was not ok ' + response.statusText);
                                }
                                return response.json();
                            })
                            .then(data => {
                                console.log('Data received:', data);

                                // Update HTML elements with data
                                document.querySelector('.real-time-temp').textContent = data.temperature + 'Â°C';
                                document.querySelector('.real-time-humidity').textContent = data.humidity + '%';
                                document.querySelector('.real__soil').textContent = data.soil_moisture + ' %';
                                document.querySelector('.battery__level').textContent = data.battery_percentage + ' %';
                                document.querySelector('.real__sun').textContent = data.light_intensity+ ' %';
                                document.querySelector('.battery_charging').textContent = data.battery_status;
                                // Assuming you have other elements to update, for example:


                                // Formatting the date
                                var createdDate = new Date(data.created_date);
                                var weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                                var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                                var formattedDate = weekdays[createdDate.getDay()] + ', ' +
                                    months[createdDate.getMonth()] + ' ' +
                                    createdDate.getDate() + ', ' +
                                    createdDate.getFullYear() + ' at ' +
                                    ('0' + createdDate.getHours()).slice(-2) + ':' +
                                    ('0' + createdDate.getMinutes()).slice(-2);
                                document.querySelector('.real-time').textContent = formattedDate;
                            })
                            .catch(error => {
                                console.error('Error fetching data:', error);
                            });
                    });
                </script>
                <script>
                    // Function to display or hide the warning message
                    function toggleRotateWarning() {
                        const rotateWarning = document.getElementById('rotateWarning');

                        // Check if it's a mobile device and in landscape orientation
                        if (/Mobi/.test(navigator.userAgent) && window.innerWidth > window.innerHeight) {
                            rotateWarning.style.display = 'flex';
                        } else {
                            rotateWarning.style.display = 'none';
                        }
                    }

                    // Initial call to check and display warning if needed
                    toggleRotateWarning();

                    // Add an event listener to check and display warning on window resize
                    window.addEventListener('resize', toggleRotateWarning);
                </script>
                <script>
                    // Wait for the DOM to be fully loaded
                    document.addEventListener('DOMContentLoaded', function () {
                        // Get the sidebar and toggle button elements
                        var sidebar = document.getElementById('sidebar');
                        var sidebarToggle = document.getElementById('sidebarToggle');

                        // Check if both elements exist
                        if (sidebar && sidebarToggle) {
                            // Add click event listener to the toggle button
                            sidebarToggle.addEventListener('click', function () {
                                // Toggle the 'active' class on the sidebar
                                sidebar.classList.toggle('active');
                            });
                        } else {
                            console.error('Sidebar or toggle button not found!');
                        }
                    });
                </script>
                <script>
                    function toggleScrolling() {
                        const isMobileView = window.innerWidth <= 1279; // Adjust the breakpoint as needed
                        const body = document.body;

                        if (isMobileView) {
                            body.style.overflowY = "scroll";
                        } else {
                            body.style.overflowY = "hidden";
                        }
                    }

                    // Initial call to set scrolling based on window width
                    toggleScrolling();

                    // Add an event listener to adjust scrolling when the window is resized
                    window.addEventListener("resize", toggleScrolling);


                    // Initial call to set scrolling based on window width
                    toggleScrolling();

                    // Add an event listener to adjust scrolling when the window is resized
                    window.addEventListener("resize", toggleScrolling);
                </script>
                <script>
                    window.onscroll = function () {
                        var hamburgerMenu = document.querySelector('.hamburger-menu');
                        var sidebar = document.querySelector('.sidebar');

                        // Check if page is scrolled more than 100px or if sidebar has 'active' class
                        if (window.pageYOffset > 100 || (sidebar && sidebar.classList.contains('active'))) {
                            hamburgerMenu.style.position = 'fixed';
                            // Add any additional styles you need, like left, right, etc.
                        } else {
                            hamburgerMenu.style.position = 'relative'; // or your default position
                            // Reset any additional styles if needed
                        }
                    };
                </script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js"
                integrity="sha512-ZwR1/gSZM3ai6vCdI+LVF1zSq/5HznD3ZSTk7kajkaj4D292NLuduDCO1c/NT8Id+jE58KYLKT7hXnbtryGmMg=="
                crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        
                <script>
                    // Function to determine if the dark mode is active
                    function isDarkMode() {
                        return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                    }
                
                    // Function to update chart colors based on the theme
                    function updateChartColors(chart) {
                        const darkMode = isDarkMode();
                        const textColor = darkMode ? '#ddd' : '#333';
                        const gridColor = darkMode ? "rgba(255, 255, 255, 0.1)" : "rgba(0, 0, 0, 0.1)";
                        chart.options.scales.x.ticks.color = textColor;
                        chart.options.scales.y.ticks.color = textColor;
                        chart.options.scales.x.grid.color = gridColor;
                        chart.options.scales.y.grid.color = gridColor;
                        chart.options.plugins.title.color = textColor;
                        chart.update();
                    }
                
                    // Function to generate dates based on the device type
                    function generateDateRange() {
                        const today = new Date();
                        const dates = [];
                        const isMobile = window.innerWidth <= 767; // Define mobile width threshold
                        const dateCount = isMobile ? 4 : 10; // Set date count based on device type
                        for (let i = -dateCount; i <= dateCount; i++) {
                            let date = new Date();
                            date.setDate(today.getDate() + i);
                            dates.push(date);
                        }
                        return dates;
                    }
                
                    // Formatting date for display (e.g., "Jan 01" or "Today")
                    function formatDate(date) {
                        const today = new Date();
                        const options = { month: 'short', day: 'numeric' };
                        if (date.setHours(0, 0, 0, 0) === today.setHours(0, 0, 0, 0)) {
                            return `Today`; // Make today's date bold
                        } else {
                            return date.toLocaleDateString('en-US', options);
                        }
                    }
                
                   // Generate data for the chart
const today = new Date();
const dateRange = generateDateRange();
let previousPredictedGrowth = Math.random() * 100;
let previousActualGrowth = Math.random() * 100;

const data = dateRange.map(date => {
    const predictedGrowth = previousPredictedGrowth + Math.random() * 10; // Adjust the growth range as needed
    const actualGrowth = date <= today ? previousActualGrowth + Math.random() * 10 : null; // Adjust the growth range as needed
    previousPredictedGrowth = predictedGrowth;
    previousActualGrowth = actualGrowth;

    return {
        date: formatDate(date),
        predictedGrowth: predictedGrowth,
        actualGrowth: actualGrowth
    };
});

                
                    // Chart configurations
                    const chart = new Chart(document.getElementById('predictive-analysis-chart'), {
                        type: 'line',
                        data: {
                            labels: data.map(row => row.date),
                            datasets: [
                                {
                                    label: 'Predicted Growth',
                                    data: data.map(row => row.predictedGrowth),
                                    borderColor: '#47815d', // Hex color for predicted growth
                                    borderDash: [5, 5], // Make predicted data a dash line
                                    tension: 0.1
                                },
                                {
                                    label: 'Actual Growth',
                                    data: data.map(row => row.actualGrowth),
                                    borderColor: '#8cfe99', // Hex color for actual growth
                                    tension: 0.1
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                },
                                title: {
                                    display: true,
                                    text: 'Growth Analysis Over Days'
                                },
                            },
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Date'
                                    },
                                    grid: {},
                                    ticks: {}
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Growth (cm)'
                                    },
                                    grid: {},
                                    ticks: {}
                                }
                            },
                        },
                    });
                
                    // Initial color update
                    updateChartColors(chart);
                
                    // Listen for changes in color scheme
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
                        updateChartColors(chart);
                    });
                </script>
                
                
        
            </div>
        </div>
    </div>
</body>

</html>